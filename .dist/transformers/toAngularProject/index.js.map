{"version":3,"sources":["transformers/toAngularProject/index.js"],"names":[],"mappings":"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","file":"transformers/toAngularProject/index.js","sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nimport _ from 'lodash';\n\nimport {createRoutes, createConfigs, createApp, directive, factory, index, moduleIndex, style, template} from './component';\n\nexport function toAngularProject(project, directory = '.') {\n  const projectRoot = `${process.env.project_root || directory}/${project.name}`,\n        sourceRoot = path.join(projectRoot, 'src'),\n        modulesRoot = path.join(sourceRoot, 'modules');\n\n  project.rootModule = getFirstModuleWithComponents(project);\n\n  [projectRoot, sourceRoot, modulesRoot].forEach(createDirectory);\n\n  project.modules.forEach(processModule);\n\n  _.each({\n    'app.js': createApp(project),\n    'app.less': `body { .unmodified-component { text-align: center; } .children { display: flex; justify-content: center; align-items: center; * { flex: 1; } } }\\n`,\n    'index.html': index(project)\n  }, (content, name) => createFile(path.join(sourceRoot, name), content));\n\n  return project;\n\n  function getFirstModuleWithComponents(project) {\n    // note: these are not necessarily in the order of the source file...\n    for (let i = 0; i < project.modules.length; i++) {\n      const module = project.modules[i];\n\n      if (module.components && module.components.length > 0) return module.name;\n    }\n  }\n\n  function processModule(module) {\n    const moduleRoot = path.join(modulesRoot, module.name),\n          directivesRoot = path.join(moduleRoot, 'directives'),\n          factoriesRoot = path.join(moduleRoot, 'factories');\n\n    createDirectory(moduleRoot);\n\n    if (module.routes) {\n      module.configs.unshift('routes'); // mutation\n      processRoutes(module.routes);\n    }\n\n    if (module.components) processComponents(module.components);\n    if (module.factories) processFactories(module.factories);\n    if (module.configs) processConfigs(module.configs);\n\n    createModuleIndex(module);\n\n    function processRoutes(routes) {\n      createFile(path.join(moduleRoot, 'routes.js'), createRoutes(routes));\n    }\n\n    function processComponents(components) {\n      createDirectory(directivesRoot);\n\n      components.forEach(componentProcessor(directivesRoot));\n\n      function componentProcessor(root, parent = {path: `./directives`}) {\n        return component => {\n          component.path = `${parent.path}/${component.name}`; // mutation\n          component.components.forEach(componentProcessor(prepareDirectory(component), component));\n        };\n\n        function prepareDirectory(component) {\n          const componentRoot = path.join(root, component.name);\n\n          createDirectory(componentRoot);\n          createFiles(componentRoot, component);\n\n          return componentRoot;\n        }\n\n        function createFiles(directory, component) {\n          const root = path.join(directory, component.name);\n\n          createFileIfNotExists(path.join(directory, 'template.html'), template(component));\n          createFileIfNotExists(path.join(directory, 'style.less'), style(component));\n          createFileIfNotExists(path.join(directory, 'index.js'), directive(component));\n        }\n      }\n    }\n\n    function processFactories(factories) {\n      createDirectory(factoriesRoot);\n\n      factories.forEach(factoryProcessor(factoriesRoot));\n\n      function factoryProcessor(root, parent = {path: `./factories`}) {\n        return factory => {\n          factory.path = `${parent.path}/${factory.name}`; // mutation\n          return factory.factories.map(factoryProcessor(prepareDirectory(factory), factory));\n        };\n\n        function prepareDirectory(factory) {\n          const factoryRoot = path.join(root, factory.name);\n\n          createDirectory(factoryRoot);\n          createFiles(factoryRoot, factory);\n\n          return factoryRoot;\n        }\n\n        function createFiles(directory, f) {\n          const root = path.join(directory, f.name);\n\n          createFileIfNotExists(path.join(directory, 'index.js'), factory(f));\n        }\n      }\n    }\n\n    function processConfigs(configs) {\n      configs.forEach(config => createFileIfNotExists(path.join(moduleRoot, `${config}.js`), createConfigs(config)));\n    }\n\n    function createModuleIndex(module) {\n      createFile(path.join(moduleRoot, 'index.js'), moduleIndex(module));\n    }\n  }\n}\n\nfunction addDependenciesToPackageDotJSON(dependencies) {\n\n}\n\nfunction createDirectory(directory) {\n  if (!fs.existsSync(directory)) {\n    console.log(`Creating D '${directory}'`);\n    fs.mkdirSync(directory);\n  }\n}\n\nfunction createFileIfNotExists(path, content) {\n  if (!fs.existsSync(path)) createFile(path, content);\n}\n\nfunction createFile(path, content) {\n  console.log(`Creating F '${path}'`);\n  fs.writeFileSync(path, content);\n}"],"sourceRoot":"/source/"}